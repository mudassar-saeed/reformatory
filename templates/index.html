<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>PDF→Word</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-gray-100 to-gray-300 min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="bg-black shadow">
        <div class="max-w-6xl mx-auto px-6 py-4 flex items-center">
            <img src="{{ url_for('static', filename='logo.png') }}" alt="ReFormatory Logo" class="w-8 h-8 mr-2">
            <span class="text-white text-xl font-semibold tracking-wide">
                ReFormatory
            </span>
        </div>
    </nav>


    <!-- Upload Section -->
    <div class="flex-grow flex items-center justify-center">
        <div class="bg-white shadow-xl rounded-xl p-8 w-full max-w-md">

            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">
                PDF to Word Converter
            </h2>

            <form id="uploadForm" enctype="multipart/form-data">

                <!-- Drag & Drop -->
                <div id="dropArea"
                    class="border-2 border-dashed border-indigo-400 rounded-lg p-6 text-center cursor-pointer hover:bg-indigo-50 transition">
                    <p class="text-gray-600">
                        Drag & Drop your PDF here
                    </p>
                    <p class="text-sm text-gray-400 mt-2">
                        or click to browse
                    </p>

                    <input type="file" name="file" id="fileInput" accept=".pdf" required class="hidden">
                </div>

                <p id="fileName" class="text-sm text-gray-600 mt-3 text-center"></p>

                <button id="convertBtn" type="submit"
                    class="w-full mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 rounded-lg transition duration-300 flex items-center justify-center gap-2">

                    <span id="btnText">Convert to Word</span>

                    <!-- Spinner -->
                    <svg id="btnSpinner" class="w-5 h-5 animate-spin hidden" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="white" stroke-width="4"></circle>
                        <path class="opacity-75" fill="white" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z">
                        </path>
                    </svg>

                    <!-- Tick -->
                    <svg id="btnSuccess" class="w-5 h-5 hidden" fill="none" stroke="white" stroke-width="3"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                    </svg>

                </button>

            </form>

        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-black text-gray-300 mt-auto">
        <div class="max-w-6xl mx-auto px-3 py-3 text-center">
            <h3 class="text-xl font-semibold text-white">
                Simple. Fast. Reliable.
            </h3>
            <div class="text-xs text-gray-500">
                © 2026 ReFormatory · Created by Mudassar Saeed
            </div>
        </div>
    </footer>


    <script>
        const dropArea = document.getElementById("dropArea");
        const fileInput = document.getElementById("fileInput");
        const fileNameDisplay = document.getElementById("fileName");
        const uploadForm = document.getElementById("uploadForm");
        const loadingOverlay = document.getElementById("loadingOverlay");
        const spinner = document.getElementById("spinner");
        const successIcon = document.getElementById("successIcon");
        const overlayText = document.getElementById("overlayText");

        // Drag & Drop Logic
        dropArea.addEventListener("click", () => fileInput.click());

        fileInput.addEventListener("change", () => {
            if (fileInput.files.length > 0) {
                fileNameDisplay.textContent = "Selected: " + fileInput.files[0].name;
            }
        });

        ["dragenter", "dragover", "dragleave", "drop"].forEach(eventName => {
            dropArea.addEventListener(eventName, e => e.preventDefault());
        });

        dropArea.addEventListener("dragover", () => {
            dropArea.classList.add("bg-indigo-100");
        });

        dropArea.addEventListener("dragleave", () => {
            dropArea.classList.remove("bg-indigo-100");
        });

        dropArea.addEventListener("drop", (e) => {
            dropArea.classList.remove("bg-indigo-100");

            if (e.dataTransfer.files.length > 0) {
                fileInput.files = e.dataTransfer.files;
                fileNameDisplay.textContent = "Selected: " + e.dataTransfer.files[0].name;
            }
        });


        const convertBtn = document.getElementById("convertBtn");
        const btnText = document.getElementById("btnText");
        const btnSpinner = document.getElementById("btnSpinner");
        const btnSuccess = document.getElementById("btnSuccess");

        uploadForm.addEventListener("submit", async (e) => {
            e.preventDefault();

            if (!fileInput.files.length) {
                alert("Please select a file.");
                return;
            }

            // Start Loading State
            convertBtn.disabled = true;
            btnText.textContent = "Converting...";
            btnSpinner.classList.remove("hidden");
            btnSuccess.classList.add("hidden");

            const formData = new FormData();
            formData.append("file", fileInput.files[0]);

            try {
                const response = await fetch("/", {
                    method: "POST",
                    body: formData
                });

                if (!response.ok) {
                    throw new Error("Conversion failed.");
                }

                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);

                const a = document.createElement("a");
                a.href = url;
                a.download = "converted.docx";
                document.body.appendChild(a);
                a.click();
                a.remove();

                window.URL.revokeObjectURL(url);

                // Success State
                btnSpinner.classList.add("hidden");
                btnSuccess.classList.remove("hidden");
                btnText.textContent = "Done!";

                // Reset after 1.5s
                setTimeout(() => {
                    btnSuccess.classList.add("hidden");
                    btnText.textContent = "Convert to Word";
                    convertBtn.disabled = false;
                }, 1500);

            } catch (error) {
                btnSpinner.classList.add("hidden");
                btnText.textContent = "Failed";

                setTimeout(() => {
                    btnText.textContent = "Convert to Word";
                    convertBtn.disabled = false;
                }, 1500);
            }
        });


    </script>

</body>

</html>